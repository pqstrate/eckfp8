use std::sync::OnceLock;

use crate::basefield::from_coeffs;
use crate::{Affine, ScalarBits, ScalarField};
use p3_koala_bear::KoalaBear;

static GENERATOR_X_COEFFS: [[u32; 8]; 256] = [
    [0, 0, 0, 0, 0, 0, 0, 0],
    [
        1813646457, 1763905369, 2115217807, 1299273209, 1825476283, 438909494, 1368232771,
        1195559694,
    ],
    [
        191121194, 2047162328, 715261316, 1712628817, 2034065120, 342297662, 1264830206, 1431654644,
    ],
    [
        59619026, 1228323174, 120668176, 1257928744, 1977748670, 1978998154, 1472701608, 547349579,
    ],
    [
        1389904160, 717347122, 56437722, 1658213305, 1038173091, 1377273978, 63660621, 2113910551,
    ],
    [
        1499580993, 1065234922, 2046402815, 425042328, 2067978223, 253199234, 2127362496,
        1232800680,
    ],
    [
        860980717, 798399549, 1453102234, 24758340, 1395153931, 1534772642, 921961165, 1830725193,
    ],
    [
        1920291004, 946631263, 1814816372, 1831892529, 173374159, 723537573, 866946674, 1646598005,
    ],
    [
        847818055, 168574015, 204372280, 825181446, 1724656243, 882735644, 1197194388, 2071224270,
    ],
    [
        1088246759, 1363657967, 1538599021, 1362783489, 1971727853, 735822676, 217953156, 498380316,
    ],
    [
        220280890, 1618018584, 1919882219, 1800585516, 309392443, 478998350, 1009008738, 1534443017,
    ],
    [
        971734476, 246140822, 551391464, 1123586097, 738216610, 1199050843, 420551669, 282532733,
    ],
    [
        115383610, 335485686, 1742878905, 331754706, 1766602373, 898939480, 497770939, 792202510,
    ],
    [
        940208485, 1493010997, 1003153317, 610852085, 1411672088, 1771408848, 783559504, 1561199712,
    ],
    [
        575072648, 516909692, 897006179, 172358372, 630591920, 327683272, 984479118, 1470516253,
    ],
    [
        558175954, 1391407708, 513829371, 1132950711, 134788237, 1193946316, 1967873237, 329683105,
    ],
    [
        723095037, 1051505555, 111944833, 2063424411, 123924663, 163200913, 1435968330, 1205154098,
    ],
    [
        1000630324, 204447348, 2063522042, 163557520, 1705573895, 1401351937, 1447881036,
        1579654011,
    ],
    [
        871686749, 431843066, 1255522165, 868280937, 2004860531, 1187751398, 1877971565, 1512497253,
    ],
    [
        635469772, 288295425, 1591821307, 823668595, 426074597, 2020902123, 1911266318, 1056033364,
    ],
    [
        1990253182, 381465949, 896600202, 204315303, 1599784840, 379268299, 205118055, 464554347,
    ],
    [
        713932501, 1522044439, 1054606190, 322615885, 1297242927, 1247925441, 595062054, 18284380,
    ],
    [
        1715654515, 1946232373, 441924933, 2104664695, 1777189054, 2095119204, 418620144,
        1573394026,
    ],
    [
        1618490672, 2104994679, 140485041, 1063423059, 1687203834, 493800681, 1775427218, 572676119,
    ],
    [
        1931036163, 480243725, 1269009950, 380271681, 155436188, 1591628692, 1119789013, 101618293,
    ],
    [
        2078418957, 1669717146, 1665119315, 801886257, 2048166164, 653559263, 1556033873, 718410736,
    ],
    [
        1597679900, 805294361, 627496389, 854750376, 472884867, 2124449202, 1116137100, 399524467,
    ],
    [
        933898517, 207730050, 72220774, 563491629, 1386699687, 1277843559, 338193215, 536371197,
    ],
    [
        1616560772, 1979557776, 460481867, 1658055495, 1249124245, 46225071, 1623329728, 1104803074,
    ],
    [
        1222252151, 1842438556, 1783472322, 200113973, 21370937, 330851794, 1582432005, 1763930525,
    ],
    [
        811308018, 807280753, 1406762264, 1888884820, 1552166956, 68303529, 1736006960, 579599156,
    ],
    [
        801243449, 64344648, 1582905157, 1994162616, 1313292486, 344424516, 1372230654, 1368818222,
    ],
    [
        328018728, 253419616, 1703566771, 641446636, 1085814906, 2032346244, 799588112, 1690490767,
    ],
    [
        701242377, 199929285, 1206063379, 120111184, 1259874690, 223910950, 1033511884, 2076359341,
    ],
    [
        1712526550, 1493482931, 1788525469, 1319716517, 592188235, 643439951, 261126861, 662003665,
    ],
    [
        267865075, 89530385, 815469958, 1739297026, 2057821380, 1970359463, 875364589, 1464495143,
    ],
    [
        793047803, 1731546424, 1521522111, 247407653, 7048647, 1633682227, 1117351414, 772673936,
    ],
    [
        1222318924, 282012773, 1814774579, 1603906163, 1792357237, 1426215951, 1539658170,
        615288592,
    ],
    [
        1175948107, 825095289, 1427182500, 1811358631, 872219333, 1430331684, 297661039, 887251750,
    ],
    [
        1388028571, 1584998037, 544066842, 562776701, 52155114, 20338003, 797220377, 204792875,
    ],
    [
        126942932, 1479390164, 339781658, 962425752, 18094261, 1402753012, 516087206, 1824264772,
    ],
    [
        1066407787, 1430500648, 1927362276, 154899867, 1109258769, 119524523, 2118745412,
        1463356932,
    ],
    [
        1950773307, 695538812, 857308426, 546863663, 2112018465, 110130329, 263833655, 1420846855,
    ],
    [
        94427654, 205090379, 856670126, 1970676163, 1606609312, 605993791, 1574147348, 1377882488,
    ],
    [
        104877079, 1188396437, 1275269641, 413051913, 343583440, 292856331, 1205062854, 801558779,
    ],
    [
        601822374, 1361220746, 745687158, 445462819, 1098428225, 528156595, 1783530615, 1193299607,
    ],
    [
        1258640769, 1333425829, 1255397763, 1539118351, 1910975323, 459924923, 2056849280,
        1203821439,
    ],
    [
        871236391, 101827435, 1242742051, 23644289, 1661961554, 872829305, 654983585, 1931373821,
    ],
    [
        1741422203, 39344674, 386113282, 208595803, 1138773855, 1694252248, 2030997342, 74116243,
    ],
    [
        747760042, 617565719, 2040799779, 1840555641, 1057104203, 429405500, 1835958421, 1369371383,
    ],
    [
        278960007, 821805459, 162115326, 743448278, 1984434478, 1358825307, 1840860351, 945059840,
    ],
    [
        302366145, 1777265774, 1249366023, 1912693795, 1750477966, 675304211, 1117286082, 767813097,
    ],
    [
        1977872075, 1403524442, 1769954749, 1756169484, 400118609, 865643922, 1262935805, 794480238,
    ],
    [
        1930059185, 1412315682, 1587453193, 1692817624, 999005508, 694938078, 521623221, 920388061,
    ],
    [
        2120969257, 1987197783, 1154567274, 735448334, 95047599, 128639955, 1336468481, 116222579,
    ],
    [
        1117575858, 38696589, 1211049340, 809282950, 712834892, 302450210, 1847434413, 1016077384,
    ],
    [
        179364352, 1655221462, 795094626, 2017044044, 1934571655, 283830544, 346543440, 326834535,
    ],
    [
        1951386635, 1838133616, 1294697267, 657620808, 844231897, 1135781718, 304044041, 827092965,
    ],
    [
        225192982, 1143761997, 229578743, 1542333947, 1058188521, 1172884408, 499347878, 1891929352,
    ],
    [
        580859486, 425131986, 132166022, 1674052171, 1349149778, 938982948, 1103659594, 620900037,
    ],
    [
        1929505617, 754613291, 585041899, 1317547573, 762007072, 210228367, 1610169964, 229713153,
    ],
    [
        1616527448, 1676388573, 1597052744, 355749414, 1583460363, 215056101, 1602657229,
        2037559677,
    ],
    [
        802250310, 1083498030, 2003843604, 1634363911, 1175787412, 1106345020, 414764938,
        1981788322,
    ],
    [
        1885754396, 2066104208, 1164973572, 1347778655, 432436144, 2063233836, 375433341, 743598692,
    ],
    [
        1982858736, 694594239, 1767558424, 1282680909, 1302918888, 955325637, 303480104, 122482146,
    ],
    [
        438272853, 1212048657, 1034705083, 1454121716, 852006834, 1253663879, 1721898406,
        1799643548,
    ],
    [
        387291167, 272247164, 1312815767, 887737536, 1560288485, 1357886688, 1858238402, 1350210509,
    ],
    [
        1875583348, 1546090748, 1225788257, 625033321, 1623113697, 1357733731, 1010383277,
        2114909594,
    ],
    [
        1935673358, 318133747, 1453621557, 135937620, 117947934, 1600204410, 1085369506, 1218274027,
    ],
    [
        1980072513, 150639754, 1568159306, 376798474, 923892135, 1731710807, 33285548, 1814242100,
    ],
    [
        1580459520, 2081200980, 1521233413, 1935077943, 1954105765, 1016397032, 541155858,
        163216848,
    ],
    [
        1983407870, 822613909, 1944047332, 1741557168, 976380686, 1385121218, 1653560455,
        1710153612,
    ],
    [
        1504653520, 847132414, 1629493177, 392880488, 926768040, 1038286657, 1186916836, 1510465206,
    ],
    [
        1754351449, 1503715815, 173592906, 797691551, 1298311457, 807833403, 695386279, 777935505,
    ],
    [
        391463293, 1157128006, 343893698, 1547103378, 840565229, 1802165443, 1925355359, 578351318,
    ],
    [
        1421074206, 1452960860, 2007496466, 2030824949, 613685211, 1254559448, 127789756, 19147168,
    ],
    [
        183783354, 884529388, 1584757040, 630604536, 971936239, 873985297, 1054345176, 378695631,
    ],
    [
        1839879649, 601427855, 1562788730, 1681528372, 1896054546, 2058042665, 945678077, 44138634,
    ],
    [
        1879971869, 1378907166, 2098594235, 153856328, 1397882023, 1752579005, 574652161, 505821281,
    ],
    [
        316396182, 642520434, 80837347, 522945522, 1082743411, 23802110, 1004577496, 327468483,
    ],
    [
        422931914, 1890350224, 37546890, 621195481, 1929500139, 1842554114, 78245734, 1845336145,
    ],
    [
        34589449, 771754524, 515617619, 1872775208, 384652969, 1333306224, 446396610, 1717349929,
    ],
    [
        1601634523, 552622197, 1773917347, 1581280478, 1026697444, 504410431, 224119483, 1773173241,
    ],
    [
        1987281356, 226673156, 726635375, 1312191649, 805922710, 1628118087, 503344446, 706118789,
    ],
    [
        1308495531, 964607234, 1317199337, 652083848, 475358506, 838769241, 151271988, 1439568141,
    ],
    [
        1456972421, 2020298689, 1985923999, 264684511, 1685158192, 672319860, 2111433049, 944152401,
    ],
    [
        806261939, 1080533280, 1163226321, 1034683319, 423261300, 1181735101, 600769408, 782525493,
    ],
    [
        509789361, 828974987, 1739110760, 60967714, 882278559, 1885343243, 1298941805, 1609310426,
    ],
    [
        2092386008, 1986391419, 37738052, 749966947, 1760899902, 659727291, 482907196, 1751716909,
    ],
    [
        1196723781, 616924636, 737642969, 1525275526, 1908723522, 1054099331, 1308171887, 82517065,
    ],
    [
        239132619, 167362572, 1732254888, 1195494110, 25701583, 83368627, 1169069643, 849621481,
    ],
    [
        1597445363, 271210890, 1666031420, 115991938, 416525464, 1394120905, 1502121340, 2117632172,
    ],
    [
        343481618, 1723818128, 1601724440, 967701447, 223137, 1461706457, 1209319791, 863504663,
    ],
    [
        376669506, 1983339901, 1708598587, 744707128, 464009793, 1923181714, 805028718, 1237928110,
    ],
    [
        453731639, 131888283, 920354514, 1863498867, 675911948, 1793586688, 1695844243, 1006617145,
    ],
    [
        1322037499, 227730880, 1856485536, 1757361859, 936532371, 972941038, 928016188, 652752061,
    ],
    [
        1035942566, 1962422734, 860245415, 599433437, 1823356598, 236075945, 1549686501, 1981393392,
    ],
    [
        991601067, 2033412407, 1795140756, 1479629392, 1090051087, 356749632, 158664494, 952335928,
    ],
    [
        2035532078, 225866170, 1203005793, 1239640158, 1214542236, 2014492385, 1968964837,
        1816842427,
    ],
    [
        1369404135, 1338959965, 1850833450, 1258657796, 1208926929, 964356138, 1518415965,
        1110553613,
    ],
    [
        1415300908, 614043719, 1828405447, 478241441, 1528533700, 1896760620, 1369437526, 777589667,
    ],
    [
        1796537805, 556895897, 946197466, 135829882, 1224215797, 1686726556, 1243519146, 613228085,
    ],
    [
        1267478877, 976998805, 625600347, 1772909124, 709074410, 475212865, 370509658, 588576982,
    ],
    [
        366385306, 1281861090, 1254496187, 793647624, 344773018, 1234877912, 903179450, 988904066,
    ],
    [
        1450050658, 1394557262, 397454250, 736684477, 1360089957, 1286121616, 718903593, 1656513619,
    ],
    [
        322288771, 1360876029, 87652613, 1932853349, 456474388, 1703217498, 885996927, 1695557505,
    ],
    [
        128281967, 1108821403, 1250602985, 714435667, 1848891691, 879469266, 1560889128, 1383409098,
    ],
    [
        1237758756, 2096880539, 429622827, 1491512195, 152193534, 1842900180, 147998206, 961581815,
    ],
    [
        374407883, 1277773756, 1900017701, 1799081893, 928596799, 2000624623, 1965319881,
        1343981036,
    ],
    [
        1103650576, 1887966219, 2006282209, 1036667511, 1380303215, 1217259386, 2021360440,
        1141701610,
    ],
    [
        1176268549, 152668620, 1506329392, 605927696, 271507320, 1407002524, 1725487886, 1736167974,
    ],
    [
        1050644222, 653372252, 672804826, 1327305894, 1617763607, 1559308715, 1166211815,
        1046603393,
    ],
    [
        119578111, 439518045, 251610141, 143015660, 40599058, 1259977113, 408527358, 1961088862,
    ],
    [
        1183897674, 191929916, 587682909, 576766010, 267238374, 1026712209, 1526416465, 1611431237,
    ],
    [
        549899073, 864032550, 1653888840, 1457253587, 1918666940, 813558082, 1183499890, 536757180,
    ],
    [
        110678326, 1809310523, 1208177596, 398576214, 1538608180, 422667963, 1236392416, 1730231906,
    ],
    [
        2019412469, 1669659543, 784762532, 1725732081, 1272423626, 1514631855, 145845324, 235599197,
    ],
    [
        426323131, 1709842998, 1581546971, 521914209, 1085691739, 743502042, 977474799, 1143184878,
    ],
    [
        2041928869, 693986534, 1081480658, 2003763635, 58907204, 936576997, 462949908, 788652790,
    ],
    [
        1953520880, 85477226, 183632771, 1921301556, 295764119, 511006198, 1152527659, 948725564,
    ],
    [
        1879857541, 491372818, 638305586, 1820390152, 2044873587, 2042391021, 1048020003,
        1971860891,
    ],
    [
        1826582022, 303413153, 1099028905, 2117855749, 1826352584, 1038758519, 202167757, 907718051,
    ],
    [
        374194563, 2075855101, 1266958413, 1897776982, 1518595108, 16061368, 1470569524, 538312507,
    ],
    [
        817380828, 594629444, 2063835297, 1148357827, 1697361113, 726067309, 1405669881, 1536795871,
    ],
    [
        1466371663, 1391216157, 1873927437, 226642164, 1547030368, 997360594, 1351651126, 887869926,
    ],
    [
        652359192, 2121879354, 37146603, 1816797049, 501092660, 1328292709, 1715879868, 1187680951,
    ],
    [
        76997997, 1442441768, 929733823, 1171644738, 1134820952, 938569961, 502690477, 668018629,
    ],
    [
        1740638681, 1792744568, 1249730019, 522995808, 1874115371, 269914631, 1554111866, 726463351,
    ],
    [
        635044901, 1582521425, 1451248923, 1970858017, 302117812, 1987950559, 764547238, 44354379,
    ],
    [
        766039843, 2007416349, 50333796, 1053102863, 967899169, 1958330247, 2013951271, 2100710446,
    ],
    [
        244679195, 593413724, 1857904153, 961294831, 1054637389, 1607925371, 776801888, 899168106,
    ],
    [
        1003177060, 1473703158, 1718991456, 1978349048, 1236727730, 130726574, 56948454, 716589275,
    ],
    [
        1087532914, 10313829, 467102177, 218359206, 2055119958, 171920476, 534310363, 1649829181,
    ],
    [
        1917372165, 208650351, 664535041, 1512097797, 498050169, 448538865, 552350607, 158572210,
    ],
    [
        1516101064, 1753438374, 1564990223, 1329286961, 1771877162, 401263382, 1251474034,
        1115498551,
    ],
    [
        1123817149, 816031781, 522367114, 1568081782, 921984869, 56818621, 511209054, 556601888,
    ],
    [
        614044897, 609152926, 902894185, 2052563010, 1617869548, 1100622598, 1278121323, 642618706,
    ],
    [
        1594009395, 147626358, 673403046, 1438552994, 1851007015, 162599051, 532591154, 61988033,
    ],
    [
        787352956, 1545679389, 1181325845, 1596931789, 294958704, 1764945240, 1548230372, 148547725,
    ],
    [
        1999816833, 1551645120, 1894774132, 441314497, 1748894326, 1331097690, 1978622478,
        524069572,
    ],
    [
        1959239349, 1067316356, 2080150303, 990798325, 1928238213, 540519252, 326977186, 1360968528,
    ],
    [
        268691355, 2125222792, 829256759, 592334147, 1667799978, 1730000169, 2123949744, 347935250,
    ],
    [
        763291919, 984189620, 985060744, 757771559, 1178180477, 1048240487, 1813697512, 1117955925,
    ],
    [
        1240145208, 1330232020, 388497637, 1938340422, 1224966486, 59240135, 423040353, 1003153778,
    ],
    [
        966799652, 428502265, 593807101, 1201017536, 1146499269, 803286517, 49348954, 533722515,
    ],
    [
        2104713052, 1751255136, 1565127399, 1159545804, 1762348108, 1570427172, 1172128453,
        1035014736,
    ],
    [
        1812425866, 1486729315, 300216188, 426340212, 2035885179, 773361068, 1377926370, 18784770,
    ],
    [
        159224371, 1311584581, 837625634, 871504509, 1124629609, 1871506225, 495913290, 108227565,
    ],
    [
        285974458, 1137144287, 672143979, 1791888443, 1897376986, 562924869, 1790923715, 588404519,
    ],
    [
        342970939, 511148832, 357525893, 1024881556, 1930256654, 1981874034, 1567951014, 2109201543,
    ],
    [
        1785828115, 113832457, 205725710, 986504790, 1159005278, 1562057329, 739114186, 264950758,
    ],
    [
        2035865938, 942326146, 1716908336, 640524525, 1185532563, 1568251705, 1431534491, 258085582,
    ],
    [
        1969507500, 1880093512, 2097253917, 1443799620, 1729273719, 432548001, 968312150,
        1541063869,
    ],
    [
        176769706, 971471473, 1344561254, 1445375963, 2021373199, 1405847830, 1769273519, 542571252,
    ],
    [
        615870289, 157723842, 541136497, 1029919186, 1465884898, 106050060, 1956380804, 2070012025,
    ],
    [
        1890939384, 698553734, 92332827, 611994533, 1939646300, 618778251, 365111430, 612515827,
    ],
    [
        691274891, 1175917911, 472005743, 1153639335, 2054399410, 1042344337, 1242986963,
        1242372758,
    ],
    [
        1995195774, 123472392, 395325509, 986881327, 255484317, 1612954254, 1476317403, 113523771,
    ],
    [
        2032825478, 1045750054, 613962130, 860104027, 1315590158, 1637091482, 1649283877, 236354287,
    ],
    [
        410747702, 380045535, 162300723, 1321240992, 656120150, 1967903860, 2113168122, 1190654043,
    ],
    [
        2018965362, 1793971446, 1459634815, 835737799, 1783593018, 2093756637, 426164484,
        1335493811,
    ],
    [
        1036078479, 1415099959, 610372417, 1235249062, 1419979842, 1376755951, 958213729,
        1189840893,
    ],
    [
        1380354408, 1019421142, 1981250530, 1739778298, 908431791, 842768533, 257649075, 1766413786,
    ],
    [
        423235400, 266478679, 1424722008, 698944715, 1286049957, 937214102, 1226325630, 1478697620,
    ],
    [
        1500307458, 696716045, 1124568684, 526819479, 1342318189, 1162642333, 745196941, 2109507640,
    ],
    [
        980396338, 1064456118, 246787019, 770634589, 2125175229, 1973340050, 763632775, 712964933,
    ],
    [
        1352680726, 1357009378, 1249501122, 1558782887, 570661173, 1474728417, 835381291, 774781892,
    ],
    [
        718282606, 1769067134, 2037603197, 1142735288, 2077426258, 1669019135, 1229247412,
        247750913,
    ],
    [
        725657457, 2067964936, 232115217, 696624208, 1310371361, 1111823198, 1323212645, 2128210694,
    ],
    [
        1931824420, 2038647139, 609010302, 2010621934, 180015781, 1838514387, 612782611, 2018499863,
    ],
    [
        1993023601, 651070541, 1720018191, 1365872027, 223418426, 711698965, 1102889117, 1846148417,
    ],
    [
        1593876588, 1910951088, 1065471107, 1571748539, 1470108162, 131301100, 1838438066,
        2066158402,
    ],
    [
        1578854645, 1279832038, 1230963053, 569086989, 990749013, 1888304623, 1711091357, 497109824,
    ],
    [
        409888954, 899908762, 596110396, 1633494666, 1686418263, 734870718, 1637800287, 1341280287,
    ],
    [
        1939663967, 13165466, 386818828, 304715435, 1374034012, 2042503166, 383600528, 115462585,
    ],
    [
        1930144686, 1269161919, 821731498, 1250150919, 1504462446, 853705446, 39625083, 1284152282,
    ],
    [
        1559080377, 50298263, 2102420534, 852918493, 583754028, 194199920, 1030373174, 17810331,
    ],
    [
        583850990, 47119068, 455613729, 2019887369, 670435020, 1359994481, 1687914961, 1807108506,
    ],
    [
        1363443958, 137409979, 1004741412, 1837489663, 1367097046, 1408655939, 1935148680,
        1122820350,
    ],
    [
        2102915810, 1297927676, 1461178693, 714761652, 1143939389, 1472749495, 1076435315,
        1407698303,
    ],
    [
        2100068515, 1553211055, 1579896856, 407909534, 565837284, 621795579, 1604703766, 1720042847,
    ],
    [
        865843736, 1247885867, 1128960044, 1242082261, 133593158, 309055309, 326549639, 1052204613,
    ],
    [
        1660125726, 73693657, 1723590496, 1234189348, 576765683, 1048672123, 783425739, 1995815628,
    ],
    [
        81727902, 90931504, 1383103870, 996455008, 960132803, 559456875, 1856496112, 75698161,
    ],
    [
        1929222469, 1594974043, 987028146, 1406706788, 280387624, 248140284, 933627088, 2122794376,
    ],
    [
        12955500, 1393479131, 1420260177, 655706352, 301063524, 116536591, 636433634, 1216395801,
    ],
    [
        73142201, 2000687161, 2110953352, 805297224, 1022975085, 180660621, 1860428359, 1529389279,
    ],
    [
        1820110241, 1536099059, 1740424616, 1491991091, 1811320731, 1687379606, 250470180,
        1720689299,
    ],
    [
        1487989649, 2119429840, 1952334314, 410714215, 39977276, 1274617310, 2081933927, 918101562,
    ],
    [
        1361672441, 1209887043, 1591657848, 1238327436, 2105109747, 155381342, 988848158,
        1904080871,
    ],
    [
        110000580, 409425851, 184747404, 42019105, 926502924, 807751237, 681326210, 1891597533,
    ],
    [
        2043344609, 27121621, 16868635, 1772014950, 1983062269, 930831408, 1936989552, 160426909,
    ],
    [
        1768490893, 1343768557, 1953111180, 645511754, 1112021080, 499917743, 1030026795,
        1868626764,
    ],
    [
        1071351527, 746786863, 236842304, 289315022, 1599925108, 103202999, 2014871909, 1464579609,
    ],
    [
        885640408, 470413663, 1541060824, 1990250434, 860880779, 993899074, 1552277262, 1308531678,
    ],
    [
        1240508088, 520286815, 811512742, 1503768702, 1087301728, 1218272931, 887306759, 626483829,
    ],
    [
        1487903009, 325193343, 2094783964, 2075555641, 2013982740, 623025339, 1832263278, 895256731,
    ],
    [
        690480502, 949656670, 5867170, 263324564, 60806084, 1761257273, 1899602669, 1314999927,
    ],
    [
        346925977, 98870000, 1157597161, 1070417459, 1802520568, 2054923205, 175000836, 1292494233,
    ],
    [
        856057506, 2049944209, 387419818, 1086634360, 1325526908, 1587999911, 759760404, 143447726,
    ],
    [
        1567505806, 1327398578, 621802960, 265280652, 889982626, 419686456, 1737220309, 2032880480,
    ],
    [
        872806487, 541605899, 889149793, 200829064, 1395274369, 1442401051, 1731266211, 1662099270,
    ],
    [
        609857966, 1946719508, 160316431, 562921739, 1087640848, 1685744326, 2102728101, 2120414714,
    ],
    [
        2047362610, 1316857115, 1269024086, 1873550231, 55480360, 2081220471, 1868697258, 17267667,
    ],
    [
        1473768715, 1310093590, 1242511112, 661849766, 106796596, 567154873, 548760296, 544947652,
    ],
    [
        721912033, 2038001213, 1717341873, 1755604066, 2094834832, 1496849203, 992551393,
        1028077385,
    ],
    [
        685878819, 1865832204, 987797553, 1666913783, 1968819589, 2069050558, 843487758, 356747212,
    ],
    [
        726666780, 1437739985, 593113428, 1397209465, 1773117630, 1898276030, 1692418134,
        1850992275,
    ],
    [
        1871677060, 23449996, 744545351, 1355845045, 1134408217, 1158179751, 923930938, 1922048745,
    ],
    [
        1970643154, 1948351238, 1743159902, 1554371947, 913777692, 316009531, 1445474085,
        1925638599,
    ],
    [
        1657389410, 129390540, 1310541153, 1308384828, 1367447423, 612502998, 1817466040, 118370393,
    ],
    [
        33646696, 1914769271, 1980425171, 427514069, 1939750749, 978625214, 490249999, 1800967979,
    ],
    [
        1762122607, 1707973056, 793324424, 115506556, 1079842937, 167044839, 1394800905, 2020546293,
    ],
    [
        358081013, 321181903, 374003779, 1925532, 1394310261, 850913704, 1244432305, 1762231897,
    ],
    [
        1222470993, 661251977, 1491800074, 568613716, 525879070, 1450890165, 555134118, 162969378,
    ],
    [
        105798442, 1125291084, 1562386266, 2007202668, 61420713, 1238473111, 955171712, 269265008,
    ],
    [
        1523531969, 1381142026, 1713856893, 344378852, 1940207483, 238922649, 379494590, 498445238,
    ],
    [
        255669956, 1449673413, 603523604, 1767124619, 1006164102, 121885129, 164045733, 1912650121,
    ],
    [
        329277920, 476710862, 988031169, 860539602, 201079671, 1111030035, 1962866030, 357125618,
    ],
    [
        1144806570, 1181361833, 560530652, 1909219379, 602335307, 499379250, 2075580591, 28278365,
    ],
    [
        702616257, 251846527, 460753491, 829920053, 1845682351, 261270405, 1609639594, 1115555329,
    ],
    [
        2053438008, 1921799997, 1061330351, 1047007896, 780649683, 587965559, 225092339, 36655778,
    ],
    [
        1887373649, 904876784, 2033364306, 1306054795, 1694788098, 16991355, 921273035, 279356173,
    ],
    [
        1328085786, 179298987, 21237353, 128681272, 1817659000, 1865321711, 1416080921, 1864705427,
    ],
    [
        1139097612, 854578481, 1819871952, 267658320, 238120152, 564320707, 285959092, 1781874339,
    ],
    [
        39480958, 1073992085, 958950801, 1371704395, 1664986276, 1703018639, 730711532, 1729609636,
    ],
    [
        276675408, 976958867, 1382146154, 1006477315, 1365189247, 1735694967, 530311001, 551382672,
    ],
    [
        907776079, 1097386423, 291772068, 1101146793, 70591590, 8869117, 706232108, 356704062,
    ],
    [
        367287316, 1435918675, 287402021, 278640313, 417200302, 1179369717, 1557007542, 1894538662,
    ],
    [
        241801540, 542249267, 641407413, 23125900, 1427057686, 446477287, 1515372443, 853134297,
    ],
    [
        583884703, 1697965440, 1184422537, 831446623, 963619287, 232388843, 1190130476, 1973347757,
    ],
    [
        922401868, 553249950, 853921429, 1565089042, 1829736470, 1471385109, 1206800033, 538455129,
    ],
    [
        100951942, 138263682, 1136726130, 1947736620, 2101578502, 484799030, 1631399784, 1149202572,
    ],
    [
        581951691, 1238722961, 1499107457, 1309465754, 1540314242, 2052842418, 161995980,
        1466677448,
    ],
    [
        1274652614, 1548293334, 1966590671, 1605019539, 1450706400, 1955207461, 1865221246,
        1571775171,
    ],
    [
        1092441884, 1809533481, 23815986, 378752595, 634884288, 1260159483, 2097592981, 1219282076,
    ],
    [
        1048117625, 1983793043, 934976189, 585435301, 1435923057, 945501373, 1561762967, 1879490253,
    ],
    [
        1423728947, 2119776306, 1365672657, 956301968, 306652983, 957977078, 1435719806, 2007555454,
    ],
    [
        871367509, 1481178943, 632003588, 776323908, 2063890845, 749877994, 2013947088, 2102613995,
    ],
    [
        262401741, 326823900, 1858814470, 492072081, 1288950952, 2071419796, 958171889, 691551529,
    ],
    [
        1436956820, 1863635984, 1933695952, 1476895308, 1505032737, 1938374572, 1116247718,
        572241421,
    ],
    [
        2002513694, 571230205, 194627406, 369685567, 285519049, 614038740, 1287626154, 1717000899,
    ],
    [
        1593749393, 1078594744, 1953622924, 80317737, 876819332, 485703442, 535702318, 47496349,
    ],
    [
        1258017149, 1748231143, 1040372324, 404010538, 1558831478, 185583747, 1403216238, 606339834,
    ],
    [
        1205203054, 71057110, 544776284, 1351555466, 1038989132, 1137985719, 837691107, 1372578220,
    ],
    [
        1562716099, 1099957679, 200270225, 1881663613, 1937388519, 1067957110, 2099242071,
        1229272446,
    ],
    [
        1859238344, 1401865722, 217481995, 902060918, 1922025646, 1440699957, 654113814, 1608119793,
    ],
    [
        1903903682, 1429702179, 1151765589, 1117429605, 1787519052, 1396855950, 791950922,
        153492945,
    ],
    [
        1130159399, 1270569583, 1861655559, 740203075, 1723653954, 1610202478, 1362572790,
        1303989935,
    ],
    [
        2019208789, 156671281, 852009177, 1812149103, 198984249, 1464122172, 341851299, 1449966805,
    ],
    [
        1810672710, 1906908365, 1899376871, 30749841, 1142718402, 1690666883, 343503206, 674827289,
    ],
    [
        776897499, 1053544695, 161234503, 1259079960, 1558805419, 248610900, 326301032, 120474199,
    ],
    [
        1821948742, 1215703968, 1454550662, 107828765, 370623462, 1138952237, 1778299563,
        1548140003,
    ],
    [
        277786746, 34394934, 1673627699, 1478445684, 1094028114, 981987725, 1176431705, 220487264,
    ],
    [
        1167498440, 827071420, 228295713, 1074858122, 1146263471, 1889570438, 497540366, 2105789012,
    ],
    [
        233338379, 570781181, 1713507905, 1541713985, 1939002905, 1808204504, 1074343300,
        1437638883,
    ],
];

static GENERATOR_Y_COEFFS: [[u32; 8]; 256] = [
    [0, 0, 0, 0, 0, 0, 0, 0],
    [
        376996212, 840779000, 1365273355, 655051022, 1286889583, 125328769, 434578416, 2077084094,
    ],
    [
        476416146, 1986041272, 1176643965, 1030604535, 1308880522, 1564994060, 1963196707,
        251517406,
    ],
    [
        989922554, 964828452, 227821643, 1429555609, 1120613257, 920522124, 1930714867, 1833798337,
    ],
    [
        158121364, 1537963208, 583366640, 1716924286, 220857206, 14764818, 4631913, 625479300,
    ],
    [
        1357849859, 373357529, 921613609, 1177805785, 617767255, 1909309549, 1437304702, 1018544943,
    ],
    [
        1802588127, 153229028, 403726298, 1104696154, 1752873655, 1411064662, 1634920667,
        1915678637,
    ],
    [
        545498644, 699015397, 1447821857, 1251521509, 1808009270, 1925670705, 1270799177, 964655697,
    ],
    [
        341209895, 1509819740, 991585064, 297302611, 1350170965, 1586342289, 1540143751, 730877017,
    ],
    [
        1510462308, 1761177981, 887757620, 884096561, 544585186, 191851116, 322830452, 857701916,
    ],
    [
        2037309553, 252813863, 1077337524, 179382459, 1820190003, 602352074, 1639368003, 1941281860,
    ],
    [
        371867102, 1869657829, 1567474444, 1246872590, 1605114878, 807041811, 33249277, 256882395,
    ],
    [
        4018915, 1520434675, 58023033, 2021138553, 876908227, 1198469496, 89821275, 2124104735,
    ],
    [
        1550250664, 841890678, 578573627, 1770723666, 732837406, 1435850570, 712227342, 133700008,
    ],
    [
        106464315, 1755646278, 1649675132, 1565833146, 976153132, 232277773, 1566355473, 136277579,
    ],
    [
        204718008, 243795143, 1413630836, 2123871250, 1722998248, 1951201550, 1623490695, 814235146,
    ],
    [
        1303543422, 527558281, 1267309713, 1453995007, 369863497, 1161254020, 626313393, 1248593460,
    ],
    [
        1889929941, 1086112677, 2045665397, 137216504, 99230539, 74006056, 2054389395, 642260094,
    ],
    [
        1609444359, 467468272, 1987528894, 210318461, 526940937, 1306708714, 2120761062, 127674726,
    ],
    [
        1307672394, 346347614, 1020433399, 547045520, 1210863256, 1657007727, 1698877227, 141327959,
    ],
    [
        943575529, 2055466327, 1057087105, 1882516797, 1183029973, 727667897, 937034886, 964336607,
    ],
    [
        1963912939, 2015963546, 1505201462, 1869626406, 907687197, 1534281470, 2006178671,
        1820784172,
    ],
    [
        1581376872, 1133577760, 2062155047, 364690003, 1926821591, 1975054113, 1316217090,
        281615653,
    ],
    [
        1753479841, 1035396352, 1657719049, 1722121894, 1995174660, 1078300897, 1709262940,
        455013323,
    ],
    [
        1973807481, 1959733303, 1159416873, 878070798, 710136727, 1615550712, 344878152, 1170079545,
    ],
    [
        1584883764, 981309820, 711289042, 1688797590, 1648440828, 1694568480, 1836967222,
        1163612436,
    ],
    [
        1308566461, 649481325, 2070472829, 2113926938, 499518100, 2017833331, 193460907, 604288015,
    ],
    [
        800404180, 1312761078, 1493966853, 465094292, 81596130, 1110050430, 307605642, 1771101436,
    ],
    [
        1327924325, 320948181, 2074649129, 317134278, 915088986, 1757044555, 1286264109, 1633946052,
    ],
    [
        1870208979, 1605217736, 1120792, 112521263, 1190164783, 853684171, 1954142572, 1333480956,
    ],
    [
        1634291127, 175851025, 385326228, 1172416731, 281234572, 255444152, 1324793958, 1778292714,
    ],
    [
        785892686, 486481472, 2088953291, 869249574, 2069673986, 248341231, 606015597, 1274847879,
    ],
    [
        535644129, 1769016972, 1605940556, 177912328, 1200770196, 1660651692, 261852724, 267713288,
    ],
    [
        1526036527, 1394664962, 570654658, 1798780070, 332780828, 1780498869, 1659462011,
        1069527262,
    ],
    [
        1187085100, 478014406, 1838825815, 581677281, 2009529721, 1420317617, 606840092, 1134545663,
    ],
    [
        509146534, 714241588, 1308369634, 1846722335, 716523815, 912828584, 696820913, 2030183002,
    ],
    [
        252474920, 1981055423, 865907375, 1618848248, 81868278, 428786681, 1802771391, 334466058,
    ],
    [
        545042188, 199704143, 1102498666, 1968410908, 798261480, 1513889737, 1898357659, 2026051552,
    ],
    [
        1654818871, 1268002738, 431795532, 1446531086, 477665190, 1981323043, 1992952781,
        1349539672,
    ],
    [
        272429924, 974868973, 459057067, 648481026, 1796079552, 2016146840, 2016471703, 709005430,
    ],
    [
        423005555, 2017470376, 92221872, 903082005, 1228719284, 1014002245, 309367220, 1796154403,
    ],
    [
        1943509977, 1950694039, 1336508774, 2100309219, 464987842, 1497328920, 1409875574,
        857373764,
    ],
    [
        385669394, 1979748829, 582167174, 356735595, 856754517, 556044253, 1919483025, 545545885,
    ],
    [
        769173419, 683442307, 1355574759, 1399767279, 1439042993, 1578661431, 277513122, 666545109,
    ],
    [
        703367126, 1060420381, 86441072, 2118179012, 780619516, 964593381, 94527082, 1398817503,
    ],
    [
        1460351633, 1018543017, 651377279, 489142633, 1078365090, 1650263926, 116572522, 1489765898,
    ],
    [
        159119833, 743090474, 1261238745, 293021319, 1633352603, 1045274485, 1086996676, 1548419558,
    ],
    [
        1090035447, 1143925047, 271752776, 499209379, 808709629, 1175641169, 273319059, 947862711,
    ],
    [
        991027231, 2045999835, 1160036068, 1214210051, 1374065832, 632346349, 1569289291,
        1134198225,
    ],
    [
        1338488510, 1440094275, 1615855072, 1630203032, 560181203, 463584411, 2115589919,
        1828895211,
    ],
    [
        969919926, 99979922, 1272582633, 1635762319, 768428868, 120742533, 449230421, 83703841,
    ],
    [
        1976134975, 55724070, 1944834002, 1739330046, 1591955583, 2121903695, 492901270, 305846387,
    ],
    [
        482398739, 1624099138, 1285084815, 1430864787, 990784721, 269388919, 1439112688, 1052437399,
    ],
    [
        1570585065, 1765993258, 1515856293, 1439460217, 1186801204, 560071512, 444961913,
        1804218225,
    ],
    [
        211643981, 1125763724, 1283184194, 72471808, 456554104, 1707161101, 114409407, 973829820,
    ],
    [
        1251228771, 994667631, 1221411501, 65687237, 453984789, 561921757, 1394494718, 647871266,
    ],
    [
        1850572068, 909523463, 1130915456, 66334382, 1406337678, 1518950107, 1188649050, 535749200,
    ],
    [
        328278418, 1172888635, 102915293, 288464288, 86998475, 1811958716, 74537818, 124114660,
    ],
    [
        303627317, 1014556806, 1007608642, 1688134369, 51481229, 337781349, 55280943, 356614440,
    ],
    [
        240305346, 1278219213, 279676988, 1448580023, 1930850494, 1472195968, 1309630628, 767811889,
    ],
    [
        1972679754, 1062171595, 1016564911, 1750926057, 1809325056, 406073316, 1079965097,
        928066598,
    ],
    [
        805474275, 671878368, 1760193289, 1334704684, 1613145186, 100063840, 1962856014, 860961386,
    ],
    [
        1340321279, 1447401105, 279204845, 940705292, 1605762160, 761122950, 1214404456, 774247218,
    ],
    [
        1847304588, 327969106, 1994784221, 1915922416, 753802875, 192358869, 808564400, 1702787537,
    ],
    [
        1738136609, 891235022, 1293819322, 665251694, 431212707, 509952508, 1272932058, 12375724,
    ],
    [
        225397534, 471741465, 443134397, 1488844844, 923706692, 870522416, 847436565, 1293995342,
    ],
    [
        1965208124, 982879656, 532836433, 1236325183, 48965773, 1098501837, 1247453771, 177771560,
    ],
    [
        2032229476, 2057079316, 843945339, 1058174218, 73507750, 2102629425, 1665822768, 296721533,
    ],
    [
        970555890, 1324224340, 912331173, 1015539789, 550112109, 451378813, 940487100, 397535803,
    ],
    [
        530385429, 1962658014, 1248171419, 1280893549, 1353581458, 235777021, 1689852942, 228389774,
    ],
    [
        144451253, 831654630, 1107308327, 2098533734, 1769764138, 302330360, 402941093, 1218446141,
    ],
    [
        932219359, 765458575, 1937850324, 1735481342, 484994668, 2112252644, 80093160, 586229568,
    ],
    [
        1305229801, 997549625, 264055193, 1210630657, 1178074239, 748917631, 1033552636, 1439377229,
    ],
    [
        1236651793, 974488953, 847748679, 746269368, 1558270712, 359496215, 583924741, 1313497925,
    ],
    [
        1348598349, 448255121, 1209477528, 1309488315, 1230234818, 320252117, 61318923, 1076755904,
    ],
    [
        73308936, 1429752638, 670669, 1463469733, 1636159579, 568452794, 26020239, 705792669,
    ],
    [
        93965146, 1244283666, 5279259, 1171574096, 10441258, 772119618, 1662270713, 341058043,
    ],
    [
        2126988408, 1320240454, 834221012, 1042241276, 130869455, 850943273, 1456006417, 1919444105,
    ],
    [
        1552643425, 1288603320, 1779178637, 75288451, 839858801, 2046829099, 299341724, 434145862,
    ],
    [
        534535107, 277298704, 557185175, 654282562, 381399638, 1821100074, 1254073051, 263205606,
    ],
    [
        1336374773, 1292350072, 1085087354, 155759159, 1384343908, 1121041398, 1952786870,
        1358263669,
    ],
    [
        1914859945, 2117711683, 993586781, 571666039, 1551368801, 1043467475, 1307040155, 151947404,
    ],
    [
        547069, 1443232964, 409964838, 1042451650, 204024464, 1764459473, 1112728441, 114516839,
    ],
    [
        342958864, 886783852, 1772258479, 23452427, 1787030645, 1854404559, 1072424778, 1313506705,
    ],
    [
        1039639627, 1968071209, 1464642462, 176791307, 742542120, 467518861, 1820302550, 1948215900,
    ],
    [
        1729635151, 1650074365, 600510896, 1536261876, 974291719, 979601556, 541864128, 559449061,
    ],
    [
        996332501, 1300057764, 1511796423, 507380504, 1996647238, 751062144, 1237344386, 1394668039,
    ],
    [
        2116669825, 1010415867, 1225348881, 1742534779, 1392312256, 1109520951, 351744939,
        289930509,
    ],
    [
        304110770, 1018911113, 1153235625, 1664097358, 1176959791, 1261498364, 812534890, 865982876,
    ],
    [
        1408319599, 500241594, 969963222, 1016580738, 34254722, 209768700, 1561035248, 1142858559,
    ],
    [
        1126020415, 896451510, 99314176, 70687444, 2098029088, 1210555031, 852113207, 658707940,
    ],
    [
        397536410, 1076169253, 2021118648, 273604605, 1767699814, 1686060125, 125383055, 808143650,
    ],
    [
        784268730, 1822743160, 909131038, 48510647, 181939489, 1374745566, 1351620830, 577471827,
    ],
    [
        980596833, 1621266630, 1042671797, 1120839686, 190682123, 352252427, 1299818235, 1812007026,
    ],
    [
        1847030097, 1500249495, 1310713498, 802458597, 1022099467, 1123482201, 1071891205,
        1953744202,
    ],
    [
        1420194291, 1222299850, 404774682, 607320181, 1328192488, 103961922, 867297397, 1684265242,
    ],
    [
        559736980, 808454290, 834310626, 1179639816, 715272217, 79170299, 232119540, 2065766017,
    ],
    [
        1585361042, 784573275, 1053688780, 1141774989, 92733455, 661476110, 803557239, 1686534605,
    ],
    [
        249631616, 7204316, 758025739, 1704431407, 785758239, 1135579185, 1320053317, 1410102500,
    ],
    [
        1496972894, 1032610335, 2058645732, 545260286, 1141994036, 292907184, 958435078, 488552556,
    ],
    [
        290067979, 630487610, 179086458, 1437279114, 1824970944, 703259407, 2119920806, 378248772,
    ],
    [
        1719659216, 1236194846, 2115121867, 59683818, 627503666, 1616052559, 1644615544, 1415728350,
    ],
    [
        592152012, 234703938, 290020292, 135761915, 2051828310, 1986502549, 1724788674, 1886422034,
    ],
    [
        870108505, 1287203089, 1006051423, 1155784096, 894150533, 1967467529, 2097383395,
        1150651823,
    ],
    [
        1879122562, 691076246, 18916047, 1526489801, 1829295335, 500127307, 923253309, 1208565632,
    ],
    [
        1777338258, 789193279, 859721760, 255921229, 1250354039, 1200940214, 223121438, 1387884100,
    ],
    [
        1934130851, 462044104, 2109479177, 1779254468, 1002671338, 867841003, 1981829784,
        1105805815,
    ],
    [
        285395735, 806184256, 40090214, 1702724259, 1114921423, 1441030221, 1027044377, 465418093,
    ],
    [
        1068287646, 61440845, 1155836129, 944404409, 612800338, 1236450274, 617706953, 1855120080,
    ],
    [
        615659438, 742295862, 667912451, 2066690677, 1690864022, 1191868392, 56137317, 315476778,
    ],
    [
        325222799, 825168248, 365218320, 495801792, 2030972234, 1428257921, 786929269, 346509624,
    ],
    [
        1921338529, 426658965, 1002356451, 496141231, 2095469525, 1185959083, 773039804, 768600756,
    ],
    [
        1993746300, 1971204416, 357922326, 84732851, 221285980, 875367415, 1893029791, 1459550250,
    ],
    [
        1648732303, 509809616, 1573654129, 1586945548, 1504068814, 1965542967, 703325349, 106712640,
    ],
    [
        275771279, 39220929, 175855137, 878130667, 1714651772, 1197565960, 1393863139, 1037137531,
    ],
    [
        1386298332, 1801818298, 310004388, 922721517, 949965161, 1036331251, 813385364, 517021525,
    ],
    [
        1903727729, 1529343329, 770003404, 351350777, 348046644, 63100010, 534264271, 1071743397,
    ],
    [
        1274129354, 1901994421, 964931339, 604961154, 1953346853, 962805488, 1774872851, 1278967570,
    ],
    [
        1449596345, 1539464866, 1149401674, 1511047152, 869276758, 1545925534, 1506909605,
        1899130976,
    ],
    [
        1894187666, 847426293, 309239804, 224179097, 891813697, 1311333018, 1460715492, 507821122,
    ],
    [
        984871186, 1569113055, 1531946197, 1611127223, 442928475, 2101166545, 1645423063,
        1902109388,
    ],
    [
        932245271, 694945398, 963261950, 1092541740, 299858768, 1425827005, 1978854055, 1511206893,
    ],
    [
        461545859, 2022941967, 457048682, 1913764696, 340672919, 1423194153, 14266906, 56970711,
    ],
    [
        706679741, 1769496763, 1701363939, 137588789, 892914909, 1719797695, 1562972451, 751939838,
    ],
    [
        471975723, 363481172, 1174833961, 1723614839, 1886409870, 314101431, 1234976244, 69211048,
    ],
    [
        1377018383, 914982501, 795530821, 1490021055, 706954962, 505739503, 1923098779, 214268930,
    ],
    [
        1408016355, 2009087155, 636744536, 1336364267, 1730255881, 1265348179, 1851345060,
        1662061405,
    ],
    [
        1720448006, 126925807, 1539953613, 701404468, 78759691, 1930250436, 1859488561, 309142166,
    ],
    [
        926379112, 1520926569, 1385014060, 378634704, 2006090681, 1035410587, 793486189, 545163043,
    ],
    [
        646295651, 1257702422, 717910188, 1667704463, 1305777506, 1787532516, 793979404, 1576232170,
    ],
    [
        1429275384, 1205292209, 1098817649, 1966598376, 658586498, 488732762, 1766664273, 352665882,
    ],
    [
        968543053, 334861205, 1812698409, 1838595704, 72574977, 14637545, 2109693090, 558021884,
    ],
    [
        1828737058, 1957554029, 786292396, 1383778619, 49414719, 1329775079, 356550871, 1409189246,
    ],
    [
        1140981630, 2015217006, 210277705, 58462431, 1284892206, 338654426, 525468898, 12873907,
    ],
    [
        2114914254, 610084156, 293852407, 111765168, 1009724736, 1051198121, 1445981421, 1612346531,
    ],
    [
        339263439, 1666980585, 1427774089, 656341814, 649301780, 394538730, 245441904, 1151695431,
    ],
    [
        552419397, 324740027, 1009060053, 219985319, 1686045210, 2029351729, 1664271724, 1403452025,
    ],
    [
        1049719043, 1018072472, 1408234113, 959382664, 1737786438, 985264174, 1886600035,
        2117828096,
    ],
    [
        568284012, 307278519, 1006279121, 1606567373, 1722652986, 643100193, 1825035466, 1157671797,
    ],
    [
        423689182, 346364467, 408502672, 1606466782, 1138565062, 1448645645, 1471066286, 1114161199,
    ],
    [
        708769059, 148419110, 2045071740, 439740241, 1329978387, 340029641, 313746402, 1623331032,
    ],
    [
        1875236741, 1567772082, 672677053, 616663954, 1048310521, 1879485435, 1113113002, 42145433,
    ],
    [
        1539102302, 891760629, 1740985840, 1118354648, 1153535, 297373258, 1310371351, 1795342015,
    ],
    [
        1642110599, 442698754, 903684777, 845591888, 604976105, 555210091, 2056616796, 1263824572,
    ],
    [
        559332559, 1379571348, 1397229437, 1937012075, 684750936, 343964814, 2032166072, 1466351236,
    ],
    [
        60289232, 409775409, 1152071399, 1275384840, 2011430580, 1609327653, 644740985, 768500052,
    ],
    [
        2032126651, 1555155291, 1317955826, 39481774, 1200743512, 1294613241, 1577466094, 110531477,
    ],
    [
        384282142, 1037104719, 1163677306, 430775968, 872257626, 1893853651, 1336302212, 1329596541,
    ],
    [
        207752238, 1869677612, 1627862944, 318684665, 910937214, 732348666, 983517973, 848857195,
    ],
    [
        282014003, 643310893, 1539251437, 2111826532, 1964618212, 1748631126, 1349018634,
        1212329447,
    ],
    [
        1005135638, 1193970424, 157116464, 1988488146, 1239618698, 1088889307, 736174598,
        1480252756,
    ],
    [
        467632246, 726648044, 1666272468, 1602180626, 807378514, 40055772, 1019972479, 191905,
    ],
    [
        801365124, 943600988, 1254018194, 273326817, 680368962, 1545417677, 464190737, 608006973,
    ],
    [
        425730181, 803624465, 1261241405, 818513419, 129382217, 1038883117, 2019720603, 1754251671,
    ],
    [
        1767648981, 2032739611, 1922688444, 1332703151, 1267833783, 1872111981, 115448584,
        2128554982,
    ],
    [
        3187176, 507853407, 734600284, 1857849502, 1854141443, 1009245795, 1270554579, 1327449134,
    ],
    [
        393701373, 1921913317, 1960558128, 710610856, 1692707210, 1398991379, 1031678408, 228374099,
    ],
    [
        633555030, 1145725097, 1986797747, 1108695445, 1648452563, 669851063, 910275132, 489679745,
    ],
    [
        562684470, 1298844331, 480088081, 1658426389, 598042452, 632327350, 1954295146, 696151572,
    ],
    [
        1119141164, 471879147, 1203672634, 2108775905, 761605859, 642603890, 1950170524, 1261331156,
    ],
    [
        534403396, 625731755, 278483327, 1149752429, 151745243, 360398572, 2083756433, 1834264431,
    ],
    [
        1014678906, 261023131, 1927822754, 560204124, 1872212539, 1955222794, 636188579, 1943343117,
    ],
    [
        1075703554, 1590878818, 1700339078, 1640979899, 1465202836, 732335707, 356224725,
        2038464455,
    ],
    [
        476441400, 909286157, 1204707316, 1233286673, 1949311567, 509554249, 1248806706, 711420024,
    ],
    [
        423875910, 1132237948, 1951837582, 1974279539, 937499303, 1556511549, 588717613, 511021939,
    ],
    [
        1917202334, 131052160, 1107221112, 1637075944, 278413314, 1389676221, 1255770659, 644280143,
    ],
    [
        2087484951, 783011878, 740199941, 608438733, 222143304, 622748773, 1152664775, 1888898654,
    ],
    [
        1730332561, 838044578, 1631150222, 1236539603, 164744967, 1383787006, 1723736514,
        1818415819,
    ],
    [
        1979218274, 1838076865, 1728549897, 751766321, 467652232, 329113536, 1680238713, 104236376,
    ],
    [
        1952677168, 1163516224, 1903443846, 1821517402, 2125779164, 1081353741, 1129922062,
        27417839,
    ],
    [
        952856450, 718279356, 1288156237, 1846489161, 462491437, 1393446547, 1028491895, 2129711843,
    ],
    [
        1584292845, 194177743, 458760854, 1046129615, 60301532, 2043615898, 1642338616, 209495709,
    ],
    [
        25609686, 958446514, 607428473, 149650006, 1545422615, 1785220757, 1093483958, 746789836,
    ],
    [
        1937994442, 237187204, 902547418, 1083386307, 729240675, 1530646903, 1747299234, 1835923168,
    ],
    [
        318782070, 1057590647, 1064738961, 1261832229, 1871570269, 1954850201, 255015065,
        1321460300,
    ],
    [
        927701379, 308116990, 244371386, 903296942, 1484345591, 1116618939, 1653715821, 1734375237,
    ],
    [
        799927225, 1272935479, 791380212, 1238974262, 393711851, 221019508, 1616868931, 360254488,
    ],
    [
        1214990529, 394845264, 314589246, 1378292408, 1670802064, 338033309, 15080628, 220977113,
    ],
    [
        580713447, 1324359446, 241680911, 1846465501, 1521010758, 405063955, 1639447165, 319025661,
    ],
    [
        1616143231, 361758214, 35546391, 628937511, 1930454374, 1374515810, 1939025706, 927955378,
    ],
    [
        757007332, 1153868303, 1680112666, 616667189, 1249310289, 1074890332, 168758008, 1088968935,
    ],
    [
        1967664242, 353088126, 568288312, 158958812, 556694715, 1385024868, 402184859, 721384333,
    ],
    [
        1370715915, 1040852325, 203974235, 1985007611, 1447018694, 930382721, 676754975, 1436255962,
    ],
    [
        2072769869, 674112779, 1543463858, 1111329682, 1641587210, 35372415, 518298425, 1661674543,
    ],
    [
        742877285, 385703815, 539637817, 406432506, 711429979, 1208325786, 1818230345, 496654068,
    ],
    [
        1669394353, 916216709, 1842345247, 481410707, 1333285217, 1152596557, 1681760630,
        2124610999,
    ],
    [
        1765390308, 1766105118, 1882809196, 509705362, 1921911511, 2090327734, 1638615655,
        357476794,
    ],
    [
        251096411, 1732184713, 1411222955, 704383183, 123107278, 1369224524, 533705109, 384455679,
    ],
    [
        658626241, 1665910111, 1795689449, 895409210, 100891057, 586345083, 1624646852, 609716089,
    ],
    [
        655224703, 327665844, 705631645, 261834625, 1865620912, 408757944, 302324959, 995450673,
    ],
    [
        1559655354, 874611263, 1249632272, 336532195, 1406809246, 827953879, 1027184580, 1783885260,
    ],
    [
        872437949, 2006874191, 1938613474, 770371355, 1772096871, 48100391, 1514158900, 367892399,
    ],
    [
        281598274, 981117780, 939159478, 1189415677, 1746239002, 541939498, 1068675346, 299549641,
    ],
    [
        1146833843, 708607662, 1837452062, 1958524786, 289228705, 338208784, 1938169491, 1867152281,
    ],
    [
        2017657506, 1305917769, 818301963, 1669962022, 62875667, 1413591995, 1329736416, 752027154,
    ],
    [
        826228681, 1101325885, 1529311048, 839402760, 1515697832, 777254292, 1821755008, 1646258824,
    ],
    [
        1344774032, 1976252869, 1279218070, 1169750859, 1500394242, 1198199396, 1617031183,
        244048243,
    ],
    [
        1513993767, 1347393109, 1791778957, 365319786, 1061081216, 867890343, 393882004, 197228564,
    ],
    [
        43105626, 140801021, 1789975594, 1490622165, 1139972635, 123052205, 1610205016, 1990500707,
    ],
    [
        822530814, 105342936, 1556413705, 598162332, 732763101, 1887124132, 1613177541, 73421166,
    ],
    [
        2112496817, 888012887, 2066884559, 730571526, 909963960, 1400952147, 1881276077, 120139157,
    ],
    [
        1588830066, 1356633861, 1197922957, 1421735034, 1216693063, 2058782090, 303237394,
        1856083267,
    ],
    [
        315021835, 1948947561, 1982917480, 1885639177, 2025558310, 1146408699, 893101715, 283303906,
    ],
    [
        1049514050, 1403868987, 1998108534, 863776884, 1266424437, 715261071, 500615617, 638437500,
    ],
    [
        1465647496, 347169878, 2054920609, 1533969637, 1586087921, 2124295612, 1798388603,
        444638732,
    ],
    [
        239047494, 420041413, 1485003556, 636056552, 1266460944, 690409294, 238245053, 1776302217,
    ],
    [
        448587699, 1724737315, 594731560, 1407980942, 598694669, 432557568, 1930025828, 1771444240,
    ],
    [
        1239039216, 366689587, 322893601, 645396595, 2043593155, 1076443418, 1770433228, 1210994972,
    ],
    [
        1826199296, 655538370, 716557070, 574853323, 124720644, 2063780987, 432913863, 2025972327,
    ],
    [
        1776091133, 1068466680, 497781031, 967969995, 1755769625, 1823645975, 1480519372, 172214391,
    ],
    [
        1882489070, 278576451, 653820890, 841526088, 1580410824, 1608856166, 1085241512, 1602907155,
    ],
    [
        301853795, 717184287, 1430538454, 1081675142, 68406843, 423690380, 1880381812, 720341077,
    ],
    [
        1053080040, 290685985, 869090861, 311759301, 278179333, 1322471109, 413370841, 1939817386,
    ],
    [
        908638028, 795871678, 1656844286, 467573408, 1053418443, 1908344460, 1919104353, 657517493,
    ],
    [
        847229232, 480754667, 351291414, 1352224209, 1138104486, 1806081181, 1824453792, 1832060725,
    ],
    [
        1253413722, 1303429475, 2084919492, 1655288127, 116338022, 283646843, 989917927, 1886842582,
    ],
    [
        1287740072, 431462408, 847202044, 1652022459, 1472713707, 336384099, 534666395, 1841659757,
    ],
    [
        1592656544, 300433666, 313555928, 1111328390, 1574550124, 443646265, 774396522, 708035046,
    ],
    [
        1512162408, 762835811, 1569477907, 699145781, 1839860522, 828386106, 592489126, 37931260,
    ],
    [
        1459429365, 1930086150, 1802595562, 1509568152, 598267730, 739511751, 2117892698,
        2119353337,
    ],
    [
        598239492, 566702743, 303665053, 1246648383, 978751714, 128900873, 425475355, 1710482951,
    ],
    [
        1803884005, 971040142, 1754296490, 989073962, 1513000519, 1681169052, 1915490475,
        1591214543,
    ],
    [
        424141804, 1913052336, 988006345, 68991238, 120240188, 1620140284, 2045741471, 1670288706,
    ],
    [
        1426083794, 501493592, 1525063566, 1697741309, 1216418191, 1697549870, 616877182, 577892634,
    ],
    [
        2050036632, 833058250, 288808816, 37121602, 831534127, 393076428, 1494879894, 967549064,
    ],
    [
        677127093, 568450949, 28588029, 1364010732, 11916824, 878859374, 1721374248, 1233945131,
    ],
    [
        1859588018, 125544574, 1235020626, 111009352, 957857332, 1952214956, 1967628808, 963090566,
    ],
    [
        1901285865, 632262002, 1832608712, 1144094272, 486098884, 1683642931, 412589775, 926512594,
    ],
    [
        1375703843, 1320479591, 416308906, 343490145, 32145048, 794772579, 842722821, 9487708,
    ],
    [
        1725074628, 1136316723, 1951529773, 1413118161, 1195389197, 1147656802, 1644026666,
        1022981749,
    ],
    [
        1941474993, 919855199, 352139362, 835012202, 483819368, 2044265970, 2101914088, 1381618279,
    ],
    [
        912336967, 482680113, 2015885951, 1084769343, 1473409538, 468431511, 1845608216, 2008223671,
    ],
    [
        1718647417, 249016527, 1238946583, 1269253321, 481745402, 1040177812, 1513651467,
        1976830089,
    ],
    [
        1384915969, 1548384552, 802385022, 672923794, 1154370308, 1316851942, 741320659, 750224241,
    ],
    [
        1958214657, 1918132378, 85091062, 778399344, 1508779831, 383248125, 1240084481, 130523063,
    ],
    [
        401790155, 681158861, 1893066506, 122456625, 1960857036, 1750596904, 220858942, 329691949,
    ],
    [
        513086510, 1194427508, 1569310676, 404510579, 1354007470, 772477554, 664158994, 1495875828,
    ],
    [
        1608657059, 817970628, 847673844, 1901026380, 1774469401, 2023922595, 228859912, 1076794598,
    ],
    [
        1023041231, 421373514, 674834324, 1256640614, 331747256, 1775780789, 1645669351, 1236223502,
    ],
    [
        698221912, 870546332, 1253209664, 1879649854, 3452269, 14728721, 1954513494, 1596942923,
    ],
    [
        850148310, 1631416066, 1022451179, 1084269022, 1700017335, 978182970, 979787627, 1777930788,
    ],
    [
        20232383, 1033676339, 2101197922, 1333522424, 1205167552, 1612673033, 1278000266,
        2064029946,
    ],
    [
        584985895, 205866633, 146738592, 399908564, 1376284384, 391909754, 2051472724, 384530572,
    ],
    [
        668147588, 762512729, 1684740440, 200098980, 874660279, 147024585, 1934630590, 1531369887,
    ],
    [
        869256990, 1946444607, 562309844, 1440441706, 909214861, 1022603435, 1947152242, 1472542683,
    ],
    [
        1079299900, 19075119, 750001881, 354395652, 1560456929, 1358748768, 1560087565, 391937227,
    ],
    [
        395969338, 1036714100, 398593375, 637696444, 533251608, 927116499, 1716235915, 474936537,
    ],
    [
        1425119525, 1623342676, 1492081252, 1252183598, 1969018903, 658091810, 1586124036,
        1977559578,
    ],
    [
        1617750418, 35273590, 1486785891, 952991374, 1910752944, 1004196771, 1381312126, 851012840,
    ],
    [
        144112202, 582851446, 1356406658, 1501768252, 993180176, 641853069, 965615859, 1302552277,
    ],
    [
        1964991140, 1963071242, 614131269, 328685547, 1971389793, 1124853879, 1608879923,
        1107477840,
    ],
    [
        1418211061, 36084812, 97508919, 549195226, 682496696, 795786679, 1504356212, 1070649533,
    ],
    [
        1995862557, 1480376444, 267067348, 1828884085, 2124948591, 386069621, 777286354, 1532158633,
    ],
    [
        1001445790, 2072828310, 1006787544, 1535167226, 418233786, 1790858971, 1608466842,
        538474052,
    ],
    [
        1216852111, 1205308182, 1786670444, 47383553, 2092954915, 876887994, 591163450, 1767180826,
    ],
    [
        1549726945, 239692036, 931598484, 979603294, 1923336686, 258004793, 1368549924, 1435201262,
    ],
];

pub(crate) fn affine_table() -> &'static [Affine; 256] {
    static TABLE: OnceLock<[Affine; 256]> = OnceLock::new();
    TABLE.get_or_init(|| {
        let mut table = [Affine::INFINITY; 256];
        for i in 0..256 {
            let x = from_coeffs(GENERATOR_X_COEFFS[i].map(KoalaBear::new));
            let y = from_coeffs(GENERATOR_Y_COEFFS[i].map(KoalaBear::new));
            table[i] = if i == 0 {
                Affine::INFINITY
            } else {
                Affine::new(x, y)
            };
        }
        table
    })
}

fn windowed_mul_affine(table: &[Affine; 256], scalar_limbs: [u64; 4]) -> Affine {
    let mut result = Affine::INFINITY;

    for &limb in scalar_limbs.iter().rev() {
        for shift in (0..64).step_by(8).rev() {
            result = result.double();
            result = result.double();
            result = result.double();
            result = result.double();
            result = result.double();
            result = result.double();
            result = result.double();
            result = result.double();

            let window = ((limb >> shift) & 0xFF) as usize;
            if window != 0 {
                result = result + table[window];
            }
        }
    }

    result
}

/// Multiply the fixed generator using a precomputed table (affine output).
pub fn mul_generator_affine(scalar: &ScalarField) -> Affine {
    windowed_mul_affine(affine_table(), scalar.to_u64_limbs())
}
